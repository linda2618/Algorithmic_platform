{"ast":null,"code":"import { onMounted, reactive, ref } from 'vue';\nimport { getUserList, changeUserState, putEditUsers } from '@/axios/apis';\nimport { ElMessage, resetFields } from 'element-plus';\nexport default {\n  __name: 'index',\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const queryInfo = reactive({\n      query: \"\",\n      pagenum: 1,\n      pagesize: 10\n    });\n    const usersData = ref([]);\n    const total = ref(0);\n    //查询到的用户信息对象\n    const editForm = ref({});\n    const labelPosition = ref('left');\n    //修改用户对话框的显示与隐藏\n    const editDialogVisible = ref(false);\n    //修改表单的验证规则对象\n    const editFormRules = reactive({\n      email: [{\n        required: true,\n        message: \"请输入邮箱号\",\n        trigger: \"blur\"\n      }, {\n        validator: checkEmail,\n        trigger: \"blur\"\n      }],\n      mobile: [{\n        required: true,\n        message: \"请输入手机号\",\n        trigger: \"blur\"\n      }, {\n        validator: checkMobile,\n        trigger: \"blur\"\n      }]\n    });\n    onMounted(async () => {\n      const res = await getUserList(queryInfo);\n      if (res.meta.status !== 200) {\n        return ElMessage.error('获取用户列表失败');\n      }\n      // console.log(res);\n      usersData.value = res.data.users;\n    });\n\n    // 监听 switch 开头状态的改变\n    const userStateChanged = async userInfo => {\n      const res = await changeUserState(userInfo);\n      console.log(res);\n      if (res.meta.status !== 200) {\n        userInfo.mg_state = !userInfo.mg_state;\n        return ElMessage.error('更新用户状态失败');\n      }\n      ElMessage({\n        message: '更新用户状态成功',\n        type: 'success'\n      });\n    };\n\n    //修改按钮\n    const showEditDialog = async id => {\n      //展示编辑用户的对话框\n      const res = await putEditUsers(id);\n      if (res.meta.status !== 200) {\n        return ElMessage.error(\"查询用户信息失败\");\n      }\n      editForm.value = res.data;\n      editDialogVisible.value = true;\n    };\n    //关闭修改对话框\n    // const editDialogClose = () => {\n    //     console.log(editFromRef);\n    //     console.log(editFromRef.value);\n    //     // editFromRef.value.resetFields();\n    //     console.log('SB');\n    // }\n    //点击按钮，提交修改的信息\n    const editUserInfo = () => {};\n    //删除按钮,根据id 删除对应用户信息\n    // const removeUserById = async (id) => {\n    //     //弹框询问用户是否删除数据\n    //     const confirmRes = await this.$confirm(\n    //         \"此操作将永久删除该用户, 是否继续?\",\n    //         \"提示\",\n    //         {\n    //             confirmButtonText: \"确定\",\n    //             cancelButtonText: \"取消\",\n    //             type: \"warning\",\n    //         }\n    //     ).catch((err) => err);\n    //     //如果用户 确认 删除,则返回值为 字符串 confirm\n    //     //如果用户 取消了删除,则返回值为 字符串 cancel\n    //     // console.log(confirmRes);\n    //     if (confirmRes !== \"confirm\") {\n    //         return this.$message.info(\"已取消删除\");\n    //     }\n    //     const { data: res } = await this.$http.delete(\"users/\" + id);\n\n    //     if (res.meta.status !== 200) {\n    //         return this.$message.error(\"删除用户失败\");\n    //     }\n    //     this.$message.success(\"删除用户成功\");\n    //     this.getUserList();\n    // }\n\n    const __returned__ = {\n      queryInfo,\n      usersData,\n      total,\n      editForm,\n      labelPosition,\n      editDialogVisible,\n      editFormRules,\n      userStateChanged,\n      showEditDialog,\n      editUserInfo,\n      onMounted,\n      reactive,\n      ref,\n      get getUserList() {\n        return getUserList;\n      },\n      get changeUserState() {\n        return changeUserState;\n      },\n      get putEditUsers() {\n        return putEditUsers;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get resetFields() {\n        return resetFields;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"mappings":"AAyFA,SAASA,SAAS,EAAEC,QAAQ,EAAEC,GAAG,QAAQ,KAAK;AAC9C,SAASC,WAAW,EAAEC,eAAe,EAAEC,YAAY,QAAQ,cAAc;AAEzE,SAASC,SAAS,EAAEC,WAAW,QAAQ,cAAc;;;;;;;IACrD,MAAMC,SAAS,GAAGP,QAAQ,CAAC;MACvBQ,KAAK,EAAE,EAAE;MACTC,OAAO,EAAE,CAAC;MACVC,QAAQ,EAAE;IACd,CAAC,CAAC;IAEF,MAAMC,SAAS,GAAGV,GAAG,CAAC,EAAE,CAAC;IACzB,MAAMW,KAAK,GAAGX,GAAG,CAAC,CAAC,CAAC;IACpB;IACA,MAAMY,QAAQ,GAAGZ,GAAG,CAAC,CAAC,CAAC,CAAC;IACxB,MAAMa,aAAa,GAAGb,GAAG,CAAC,MAAM,CAAC;IACjC;IACA,MAAMc,iBAAiB,GAAGd,GAAG,CAAC,KAAK,CAAC;IACpC;IACA,MAAMe,aAAa,GAAGhB,QAAQ,CAAC;MAC3BiB,KAAK,EAAE,CACH;QAAEC,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,QAAQ;QAAEC,OAAO,EAAE;MAAO,CAAC,EACtD;QAAEC,SAAS,EAAEC,UAAU;QAAEF,OAAO,EAAE;MAAO,CAAC,CAC7C;MACDG,MAAM,EAAE,CACJ;QAAEL,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,QAAQ;QAAEC,OAAO,EAAE;MAAO,CAAC,EACtD;QAAEC,SAAS,EAAEG,WAAW;QAAEJ,OAAO,EAAE;MAAO,CAAC;IAEnD,CAAC,CAAC;IAEFrB,SAAS,CAAC,YAAY;MAClB,MAAM0B,GAAG,GAAG,MAAMvB,WAAW,CAACK,SAAS,CAAC;MAExC,IAAIkB,GAAG,CAACC,IAAI,CAACC,MAAM,KAAK,GAAG,EAAE;QACzB,OAAOtB,SAAS,CAACuB,KAAK,CAAC,UAAU,CAAC;MACtC;MACA;MACAjB,SAAS,CAACkB,KAAK,GAAGJ,GAAG,CAACK,IAAI,CAACC,KAAK;IACpC,CAAC,CAAC;;IAEF;IACA,MAAMC,gBAAgB,GAAG,MAAOC,QAAQ,IAAK;MACzC,MAAMR,GAAG,GAAG,MAAMtB,eAAe,CAAC8B,QAAQ,CAAC;MAC3CC,OAAO,CAACC,GAAG,CAACV,GAAG,CAAC;MAChB,IAAIA,GAAG,CAACC,IAAI,CAACC,MAAM,KAAK,GAAG,EAAE;QACzBM,QAAQ,CAACG,QAAQ,GAAG,CAACH,QAAQ,CAACG,QAAQ;QACtC,OAAO/B,SAAS,CAACuB,KAAK,CAAC,UAAU,CAAC;MACtC;MACAvB,SAAS,CAAC;QACNc,OAAO,EAAE,UAAU;QACnBkB,IAAI,EAAE;MACV,CAAC,CAAC;IACN,CAAC;;IAED;IACA,MAAMC,cAAc,GAAG,MAAOC,EAAE,IAAK;MACjC;MACA,MAAMd,GAAG,GAAG,MAAMrB,YAAY,CAACmC,EAAE,CAAC;MAClC,IAAId,GAAG,CAACC,IAAI,CAACC,MAAM,KAAK,GAAG,EAAE;QACzB,OAAOtB,SAAS,CAACuB,KAAK,CAAC,UAAU,CAAC;MACtC;MACAf,QAAQ,CAACgB,KAAK,GAAGJ,GAAG,CAACK,IAAI;MACzBf,iBAAiB,CAACc,KAAK,GAAG,IAAI;IAClC,CAAC;IACD;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,MAAMW,YAAY,GAAG,MAAM,CAE3B,CAAC;IACD;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA","names":["onMounted","reactive","ref","getUserList","changeUserState","putEditUsers","ElMessage","resetFields","queryInfo","query","pagenum","pagesize","usersData","total","editForm","labelPosition","editDialogVisible","editFormRules","email","required","message","trigger","validator","checkEmail","mobile","checkMobile","res","meta","status","error","value","data","users","userStateChanged","userInfo","console","log","mg_state","type","showEditDialog","id","editUserInfo"],"sources":["D:/前端基础/22科技月评-算法在线刷题平台/algorithmic_platform/src/components/userList/index.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <!-- 面包屑导航区域 -->\r\n        <el-breadcrumb separator=\">\">\r\n            <el-breadcrumb-item :to=\"{ path: '/home' }\">首页</el-breadcrumb-item>\r\n            <el-breadcrumb-item>用户管理</el-breadcrumb-item>\r\n            <el-breadcrumb-item>用户列表</el-breadcrumb-item>\r\n        </el-breadcrumb>\r\n\r\n        <!-- 卡片视图区域 -->\r\n        <el-card class=\"box-card\">\r\n            <!-- 搜索区域 -->\r\n            <template #header>\r\n                <div class=\"card-header\">\r\n                    <el-row :gutter=\"25\">\r\n                        <el-col :span=\"9\">\r\n                            <el-input placeholder=\"请输入内容\" clearable>\r\n                            </el-input>\r\n                        </el-col>\r\n                        <el-col :span=\"3\">\r\n                            <el-button type=\"primary\">查询</el-button>\r\n                        </el-col>\r\n                    </el-row>\r\n                </div>\r\n            </template>\r\n\r\n            <!-- 用户列表区域 -->\r\n            <el-table :data=\"usersData\" border style=\"width: 100%\">\r\n                <el-table-column type=\"index\" label=\"id\" />\r\n                <el-table-column prop=\"username\" label=\"用户名\" />\r\n                <el-table-column prop=\"mobile\" label=\"电话\" />\r\n                <el-table-column prop=\"role_name\" label=\"角色\" />\r\n                <el-table-column prop=\"email\" label=\"邮箱\" />\r\n                <el-table-column label=\"状态\" prop=\"mg_state\">\r\n                    <!-- 用插槽包裹el-switch开关 -->\r\n                    <template v-slot=\"scope\">\r\n                        <span>封禁</span>\r\n                        <el-switch v-model=\"scope.row.mg_state\" @change=\"userStateChanged(scope.row)\" />\r\n                        <span>启用</span>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"操作\">\r\n                    <template v-slot=\"scope\">\r\n                        <!-- 修改按钮 -->\r\n                        <el-button type=\"primary\" class=\"iconfont icon-zuoti\" circle\r\n                            @click=\"showEditDialog(scope.row.id)\" size=\"large\">\r\n                        </el-button>\r\n                        <!-- 删除按钮 -->\r\n                        <el-button type=\"danger\" class=\"iconfont icon-shanchu2\" circle\r\n                            @click=\"removeUserById(scope.row.id)\" size=\"large\">\r\n                        </el-button>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n            <!-- 分页区域 -->\r\n            <el-pagination v-model:current-page=\"currentPage4\" v-model:page-size=\"pageSize4\" :page-sizes=\"[3, 5, 10]\"\r\n                :small=\"small\" :disabled=\"disabled\" :background=\"background\"\r\n                layout=\"total, sizes, prev, pager, next, jumper\" :total=\"400\" @size-change=\"handleSizeChange\"\r\n                @current-change=\"handleCurrentChange\" />\r\n        </el-card>\r\n\r\n\r\n        <!-- 修改用户的对话框 -->\r\n        <el-dialog title=\"修改用户\" ref=\"editFromRef\" v-model=\"editDialogVisible\" width=\"40%\" @close=\"editDialogClose\">\r\n            <el-form :label-position=\"labelPosition\" label-width=\"100px\" :model=\"editForm\" :rules=\"editFormRules\"\r\n                style=\"max-width: 460px\">\r\n                <el-form-item label=\"用户名\" prop=\"username\">\r\n                    <el-input v-model=\"editForm.username\" disabled />\r\n                </el-form-item>\r\n                <el-form-item label=\"电话\" prop=\"mobile\">\r\n                    <el-input v-model=\"editForm.mobile\" />\r\n                </el-form-item>\r\n                <el-form-item label=\"邮箱\" prop=\"email\">\r\n                    <el-input v-model=\"editForm.email\" />\r\n                </el-form-item>\r\n            </el-form>\r\n            <template #footer>\r\n                <span class=\"dialog-footer\">\r\n                    <el-button @click=\"editDialogVisible = false\">取消</el-button>\r\n                    <el-button type=\"primary\" @click=\"editUserInfo\">\r\n                        确定\r\n                    </el-button>\r\n                </span>\r\n            </template>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, reactive, ref } from 'vue';\r\nimport { getUserList, changeUserState, putEditUsers } from '@/axios/apis'\r\n\r\nimport { ElMessage, resetFields } from 'element-plus'\r\nconst queryInfo = reactive({\r\n    query: \"\",\r\n    pagenum: 1,\r\n    pagesize: 10,\r\n})\r\n\r\nconst usersData = ref([])\r\nconst total = ref(0)\r\n//查询到的用户信息对象\r\nconst editForm = ref({})\r\nconst labelPosition = ref('left')\r\n//修改用户对话框的显示与隐藏\r\nconst editDialogVisible = ref(false)\r\n//修改表单的验证规则对象\r\nconst editFormRules = reactive({\r\n    email: [\r\n        { required: true, message: \"请输入邮箱号\", trigger: \"blur\" },\r\n        { validator: checkEmail, trigger: \"blur\" },\r\n    ],\r\n    mobile: [\r\n        { required: true, message: \"请输入手机号\", trigger: \"blur\" },\r\n        { validator: checkMobile, trigger: \"blur\" },\r\n    ],\r\n})\r\n\r\nonMounted(async () => {\r\n    const res = await getUserList(queryInfo)\r\n\r\n    if (res.meta.status !== 200) {\r\n        return ElMessage.error('获取用户列表失败')\r\n    }\r\n    // console.log(res);\r\n    usersData.value = res.data.users\r\n})\r\n\r\n// 监听 switch 开头状态的改变\r\nconst userStateChanged = async (userInfo) => {\r\n    const res = await changeUserState(userInfo)\r\n    console.log(res);\r\n    if (res.meta.status !== 200) {\r\n        userInfo.mg_state = !userInfo.mg_state\r\n        return ElMessage.error('更新用户状态失败')\r\n    }\r\n    ElMessage({\r\n        message: '更新用户状态成功',\r\n        type: 'success',\r\n    })\r\n}\r\n\r\n//修改按钮\r\nconst showEditDialog = async (id) => {\r\n    //展示编辑用户的对话框\r\n    const res = await putEditUsers(id);\r\n    if (res.meta.status !== 200) {\r\n        return ElMessage.error(\"查询用户信息失败\");\r\n    }\r\n    editForm.value = res.data;\r\n    editDialogVisible.value = true;\r\n}\r\n//关闭修改对话框\r\n// const editDialogClose = () => {\r\n//     console.log(editFromRef);\r\n//     console.log(editFromRef.value);\r\n//     // editFromRef.value.resetFields();\r\n//     console.log('SB');\r\n// }\r\n//点击按钮，提交修改的信息\r\nconst editUserInfo = () => {\r\n\r\n}\r\n//删除按钮,根据id 删除对应用户信息\r\n// const removeUserById = async (id) => {\r\n//     //弹框询问用户是否删除数据\r\n//     const confirmRes = await this.$confirm(\r\n//         \"此操作将永久删除该用户, 是否继续?\",\r\n//         \"提示\",\r\n//         {\r\n//             confirmButtonText: \"确定\",\r\n//             cancelButtonText: \"取消\",\r\n//             type: \"warning\",\r\n//         }\r\n//     ).catch((err) => err);\r\n//     //如果用户 确认 删除,则返回值为 字符串 confirm\r\n//     //如果用户 取消了删除,则返回值为 字符串 cancel\r\n//     // console.log(confirmRes);\r\n//     if (confirmRes !== \"confirm\") {\r\n//         return this.$message.info(\"已取消删除\");\r\n//     }\r\n//     const { data: res } = await this.$http.delete(\"users/\" + id);\r\n\r\n//     if (res.meta.status !== 200) {\r\n//         return this.$message.error(\"删除用户失败\");\r\n//     }\r\n//     this.$message.success(\"删除用户成功\");\r\n//     this.getUserList();\r\n// }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}